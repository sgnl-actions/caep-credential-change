name: CAEP Credential Change
description: Transmits a Continuous Access Evaluation Protocol (CAEP) Credential Change event as a Security Event Token (SET) to a specified endpoint

inputs:
  subject:
    type: text
    description: Subject identifier JSON (e.g., {"format":"email","email":"user@example.com"})
    required: true
    validation:
      min: 1
      max: 2000

  audience:
    type: text
    description: Intended recipient of the SET (e.g., https://customer.okta.com/)
    required: true
    validation:
      min: 1
      max: 500

  credential_type:
    type: text
    description: Type of credential that changed (password, x509, fido2, etc.)
    required: true
    validation:
      min: 1
      max: 100

  change_type:
    type: text
    description: Type of change that occurred (create, revoke, update, delete)
    required: true
    validation:
      enum: ["create", "revoke", "update", "delete"]

  friendly_name:
    type: text
    description: Human-readable name for the credential (optional)
    required: false
    validation:
      max: 200

  x509_issuer:
    type: text
    description: X.509 certificate issuer (for x509 credential type)
    required: false
    validation:
      max: 500

  x509_serial:
    type: text
    description: X.509 certificate serial number (for x509 credential type)
    required: false
    validation:
      max: 200

  fido2_aaguid:
    type: text
    description: FIDO2 Authenticator Attestation GUID (for fido2 credential type)
    required: false
    validation:
      max: 100

  initiating_entity:
    type: text
    description: Entity that initiated the credential change (optional)
    required: false
    validation:
      max: 100

  reason_admin:
    type: text
    description: Admin-readable reason for the change (JSON for i18n or plain string)
    required: false
    validation:
      max: 1000

  reason_user:
    type: text
    description: User-readable reason for the change (JSON for i18n or plain string)
    required: false
    validation:
      max: 1000

  address:
    type: text
    description: Optional destination URL override (defaults to ADDRESS environment variable)
    required: false
    validation:
      min: 1
      max: 100

outputs:
  status:
    type: text
    description: Transmission status ('success' or 'failed')

  statusCode:
    type: number
    description: HTTP response status code

  body:
    type: text
    description: HTTP response body

  retryable:
    type: boolean
    description: Whether the error is retryable (for failed requests)
