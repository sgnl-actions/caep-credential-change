# Generated by sgnl-test-init â€” fill in the TODOs below
#
# Scenarios with "record: true" will be recorded by: npx sgnl-test-record
# Fill in real secrets in action.context.secrets, then run the recorder.
# After recording, redact secrets before committing.
action:
  params:
    subject: "{\"format\": \"email\", \"email\": \"alice@example.com\"}"
    audience: https://audience.example.com
    credential_type: password
    change_type: create
    friendly_name: test-friendly_name
    x509_issuer: test-x509_issuer
    x509_serial: test-x509_serial
    fido2_aaguid: test-fido2_aaguid
    initiating_entity: test-initiating_entity
    reason_admin: test-reason_admin
    reason_user: test-reason_user
    address: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
  context:
    secrets:
      BEARER_AUTH_TOKEN: auth-token
    environment: {}
    crypto:
      signJWT:
        returns: eyJhbGciOiJSUzI1NiIsImtpZCI6IjllMjJlMjc2LWQzYTQtNGE2OS1hZDA4LWQyNmNmNWI0Y2ExOSIsInR5cCI6InNlY2V2ZW50K2p3dCJ9.eyJhdWQiOiJodHRwczovL3d3dy50ZXN0LmNvbSIsImV2ZW50cyI6eyJodHRwczovL3NjaGVtYXMub3BlbmlkLm5ldC9zZWNldmVudC9jYWVwL2V2ZW50LXR5cGUvY3JlZGVudGlhbC1jaGFuZ2UiOnsiY2hhbmdlX3R5cGUiOiJjcmVhdGUiLCJjcmVkZW50aWFsX3R5cGUiOiJwYXNzd29yZCIsImV2ZW50X3RpbWVzdGFtcCI6MTc3MjIzOTE4NSwic3ViamVjdCI6eyJlbWFpbCI6InRlc3RAdGVzdC5jb20iLCJmb3JtYXQiOiJlbWFpbCJ9fX0sImlhdCI6MTc3MjIzOTE4NSwiaXNzIjoiaHR0cHM6Ly9zc2YuY2FlcC5kZXYvIiwianRpIjoiT1dNME5UZ3daREl0WVRZd055MDBaV1F6TFRsbE5HRXRPVEkzTXpoaVpXSXpOR1V4Iiwic3ViX2lkIjp7ImVtYWlsIjoidGVzdEB0ZXN0LmNvbSIsImZvcm1hdCI6ImVtYWlsIn19.UqdJiBB5dQr13mVFPC0SO4IZYI6o-zYRrNDDSmPR-UEhXHvWPHMQvwViUksTHO_BnB_bMG4eDxjhJ2vSTLdzBd0E9wk8PbYQ2ZSW46arjPNds8VaWlZADrOz4EhFyIkzSAMd9j4mb7dUgwIgzQDKEok2L7kR7eaQmHMNCkasXTjczHsgyMfVCVOZCyhC3yBXpxcNrN-riIkjYJASXNmomdB1lDaui452T7cXfIMztgGXSyBJ4Ermk4zrV2LLNlOetlqf0zSVYx9vnp0_Ac-zqZXpbXeGRz8RaTwvEBRcxVHG715Nt5XOttfa5sGYxTkW9ItNOweZngu2Re6Ki-nPeg
scenarios:
  - name: Base Success Case
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/base-success-case.http
    invoke:
      returns:
        status: success
        statusCode: 202
        body: ""
        headers:
          content-length: "0"
          date: Sat, 28 Feb 2026 00:42:36 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "8"
          x-request-id: 7aceb810-472a-407f-8fc1-ac2aa797c84d
          x-sgnl-istio-vs: sgnlapis-cloud-events
  - name: Duplicate Event
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/duplicate-event.http
    invoke:
      returns:
        status: failed
        statusCode: 409
        body:
          err: duplicate_event
          description: Failed to store the event. The event already exists.
        headers:
          content-length: "95"
          content-type: application/json
          date: Sat, 28 Feb 2026 00:43:04 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "3"
          x-request-id: 97d06135-6649-4674-8b27-7c68f8c6ebbf
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 409: Conflict"
        retryable: false
  - name: Invalid Auth Token
    context:
      secrets:
        BEARER_AUTH_TOKEN: invalid-token
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/invalid-auth-token.http
    invoke:
      returns:
        status: failed
        statusCode: 400
        body:
          err: authentication_failed
          description: The SET Recipient could not authenticate the SET Transmitter.
        headers:
          content-length: "110"
          content-type: application/json
          date: Sat, 28 Feb 2026 00:43:32 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "1"
          x-request-id: 3b44fee9-e156-45b3-abff-1cbc6f2acf6c
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 400: Bad Request"
        retryable: false
